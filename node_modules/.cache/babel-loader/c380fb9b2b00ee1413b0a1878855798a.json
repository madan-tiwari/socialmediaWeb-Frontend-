{"ast":null,"code":"var _jsxFileName = \"E:\\\\Agile Web App\\\\social media (frontend)\\\\src\\\\user\\\\Profile.js\";\nimport React, { Component } from 'react';\nimport { Redirect, Link } from 'react-router-dom';\nimport DefaultAvatar from '../images/default_avatar.png';\nimport { postsByUser } from '../post/postAPI'; //is authenticated method checks if the user is authenticated (checks the token in local storage)\n//we can conditionally show and hide links based on this helper method\n\nexport const isAuthenticated = () => {\n  if (typeof window == \"undefined\") {\n    return false;\n  }\n\n  if (localStorage.getItem(\"JWT\")) {\n    //parse the token (as it contains user information)\n    return JSON.parse(localStorage.getItem(\"JWT\"));\n  } else {\n    return false;\n  }\n};\n\nclass Profile extends Component {\n  // state\n  constructor() {\n    super();\n\n    this.read = (userId, token) => {\n      return fetch(`${process.env.REACT_APP_API_URL}/user/${userId}`, {\n        method: \"GET\",\n        // to make only authenticated user make the request\n        headers: {\n          Accept: \"application/json\",\n          \"Content-Type\": \"application/json\",\n          // jwt token from the isAuthenticated function\n          Authorization: `Bearer ${token}`\n        }\n      }).then(response => {\n        return response.json();\n      }).catch(err => console.log(err));\n    };\n\n    this.checkFollow = user => {\n      const jwt = isAuthenticated(); //if the signed in user's id is found then it means the user is already in the followers list\n\n      const match = user.followers.find(follower => {\n        return follower._id === jwt.user._id;\n      });\n      return match;\n    };\n\n    this.loadPosts = userId => {\n      const token = isAuthenticated().token;\n      postsByUser(userId, token).then(data => {\n        if (data.error) {\n          console.log(data.error);\n        } else {\n          this.setState({\n            posts: data\n          });\n        }\n      });\n    };\n\n    this.state = {\n      user: {\n        following: [],\n        followers: []\n      },\n      redirectToSignin: false,\n      following: false,\n      error: \"\",\n      posts: []\n    };\n  } //takes userId from the init\n\n\n  //lifecycle method -> when the component is mounted and be ready\n  //then we get the user id\n  componentDidMount() {\n    // console.log(\"Userrouter from route params:\", this.props.match.params.userId);\n    const userId = this.props.match.params.userId; //giving userId to init method to process\n\n    this.init(userId);\n  } //when the userid in the url changes this method gets invoked \n  //and executes init method but with different userId\n\n\n  componentWillReceiveProps(props) {\n    const userId = props.match.params.userId; //giving userId to init method to process\n\n    this.init(userId);\n  }\n\n  render() {\n    const redirectToSignin = this.state.redirectToSignin;\n    if (redirectToSignin) return /*#__PURE__*/React.createElement(Redirect, {\n      to: \"/login\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 37\n      }\n    }); //this URL gives us image\n\n    const photoUrl = this.state.user._id ? `${process.env.REACT_APP_API_URL}/user/photo/${this.state.user._id}?${new Date().getTime()}` : //new Date().getTime() => gives us the newly updated image\n    DefaultAvatar;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"h2\", {\n      className: \"mt-5 mb-5\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 17\n      }\n    }, \"PROFILE PAGE\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-md-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      style: {\n        height: \"200px\",\n        width: \"auto\"\n      },\n      className: \"img-thumbnail\",\n      src: photoUrl,\n      onError: i => i.target.src = `${DefaultAvatar}`,\n      alt: this.state.user.name,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 25\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-md-8\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"lead mt-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 29\n      }\n    }, \"Hello! \", this.state.user.name), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 29\n      }\n    }, \"Email: \", this.state.user.email), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 29\n      }\n    }, \" \", `Joined on ${new Date(this.state.user.created).toDateString()}`)), isAuthenticated().user && isAuthenticated().user._id === this.state.user._id ? /*#__PURE__*/React.createElement(\"div\", {\n      className: \"d-inline-block\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(Link, {\n      className: \"btn btn-raised btn-info mr-5\",\n      to: `/post/create`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 33\n      }\n    }, \"CREATE POST\"), /*#__PURE__*/React.createElement(Link, {\n      className: \"btn btn-raised btn-success mr-5\",\n      to: `/user/edit/${this.state.user._id}`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 33\n      }\n    }, \"Edit Profile\")) : /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 30\n      }\n    }))));\n  }\n\n}\n\nexport default Profile;","map":{"version":3,"sources":["E:/Agile Web App/social media (frontend)/src/user/Profile.js"],"names":["React","Component","Redirect","Link","DefaultAvatar","postsByUser","isAuthenticated","window","localStorage","getItem","JSON","parse","Profile","constructor","read","userId","token","fetch","process","env","REACT_APP_API_URL","method","headers","Accept","Authorization","then","response","json","catch","err","console","log","checkFollow","user","jwt","match","followers","find","follower","_id","loadPosts","data","error","setState","posts","state","following","redirectToSignin","componentDidMount","props","params","init","componentWillReceiveProps","render","photoUrl","Date","getTime","height","width","i","target","src","name","email","created","toDateString"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,QAAT,EAAmBC,IAAnB,QAA+B,kBAA/B;AACA,OAAOC,aAAP,MAA0B,8BAA1B;AACA,SAAQC,WAAR,QAA0B,iBAA1B,C,CAEA;AACA;;AACA,OAAO,MAAMC,eAAe,GAAE,MAAK;AAC/B,MAAG,OAAOC,MAAP,IAAiB,WAApB,EAAgC;AAC5B,WAAO,KAAP;AACH;;AAED,MAAGC,YAAY,CAACC,OAAb,CAAqB,KAArB,CAAH,EAA+B;AAC3B;AACA,WAAOC,IAAI,CAACC,KAAL,CAAWH,YAAY,CAACC,OAAb,CAAqB,KAArB,CAAX,CAAP;AACH,GAHD,MAGK;AACD,WAAO,KAAP;AACH;AACJ,CAXM;;AAaP,MAAMG,OAAN,SAAsBX,SAAtB,CAAgC;AAC5B;AACAY,EAAAA,WAAW,GAAE;AACT;;AADS,SAYbC,IAZa,GAYN,CAACC,MAAD,EAASC,KAAT,KAAiB;AACpB,aAAOC,KAAK,CAAE,GAAEC,OAAO,CAACC,GAAR,CAAYC,iBAAkB,SAAQL,MAAO,EAAjD,EAAoD;AAC5DM,QAAAA,MAAM,EAAC,KADqD;AAE5D;AACAC,QAAAA,OAAO,EAAE;AACLC,UAAAA,MAAM,EAAE,kBADH;AAEL,0BAAgB,kBAFX;AAGL;AACAC,UAAAA,aAAa,EAAG,UAASR,KAAM;AAJ1B;AAHmD,OAApD,CAAL,CAUNS,IAVM,CAUDC,QAAQ,IAAG;AACb,eAAOA,QAAQ,CAACC,IAAT,EAAP;AACH,OAZM,EAaNC,KAbM,CAaAC,GAAG,IAAIC,OAAO,CAACC,GAAR,CAAYF,GAAZ,CAbP,CAAP;AAcH,KA3BY;;AAAA,SA+BbG,WA/Ba,GA+BCC,IAAI,IAAG;AACjB,YAAMC,GAAG,GAAG5B,eAAe,EAA3B,CADiB,CAGjB;;AACA,YAAM6B,KAAK,GAAGF,IAAI,CAACG,SAAL,CAAeC,IAAf,CAAoBC,QAAQ,IAAG;AACzC,eAAOA,QAAQ,CAACC,GAAT,KAAiBL,GAAG,CAACD,IAAJ,CAASM,GAAjC;AACH,OAFa,CAAd;AAGA,aAAOJ,KAAP;AACH,KAvCY;;AAAA,SA0CbK,SA1Ca,GA0CDzB,MAAM,IAAI;AAClB,YAAMC,KAAK,GAAGV,eAAe,GAAGU,KAAhC;AACAX,MAAAA,WAAW,CAACU,MAAD,EAASC,KAAT,CAAX,CACCS,IADD,CACMgB,IAAI,IAAG;AACT,YAAGA,IAAI,CAACC,KAAR,EAAc;AAACZ,UAAAA,OAAO,CAACC,GAAR,CAAYU,IAAI,CAACC,KAAjB;AAAwB,SAAvC,MACI;AAAC,eAAKC,QAAL,CAAc;AAACC,YAAAA,KAAK,EAACH;AAAP,WAAd;AAA4B;AACpC,OAJD;AAMH,KAlDY;;AAET,SAAKI,KAAL,GAAY;AACRZ,MAAAA,IAAI,EAAE;AAACa,QAAAA,SAAS,EAAE,EAAZ;AAAgBV,QAAAA,SAAS,EAAE;AAA3B,OADE;AAERW,MAAAA,gBAAgB,EAAC,KAFT;AAGRD,MAAAA,SAAS,EAAE,KAHH;AAIRJ,MAAAA,KAAK,EAAC,EAJE;AAKRE,MAAAA,KAAK,EAAC;AALE,KAAZ;AAOH,GAX2B,CAa5B;;;AA0CA;AACA;AACAI,EAAAA,iBAAiB,GAAE;AACf;AACA,UAAMjC,MAAM,GAAG,KAAKkC,KAAL,CAAWd,KAAX,CAAiBe,MAAjB,CAAwBnC,MAAvC,CAFe,CAGf;;AACA,SAAKoC,IAAL,CAAUpC,MAAV;AACH,GA9D2B,CAgE5B;AACA;;;AACAqC,EAAAA,yBAAyB,CAACH,KAAD,EAAO;AAC5B,UAAMlC,MAAM,GAAGkC,KAAK,CAACd,KAAN,CAAYe,MAAZ,CAAmBnC,MAAlC,CAD4B,CAE5B;;AACA,SAAKoC,IAAL,CAAUpC,MAAV;AACH;;AAEDsC,EAAAA,MAAM,GAAG;AACL,UAAMN,gBAAgB,GAAG,KAAKF,KAAL,CAAWE,gBAApC;AACA,QAAGA,gBAAH,EAAqB,oBAAO,oBAAC,QAAD;AAAU,MAAA,EAAE,EAAC,QAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAP,CAFhB,CAIJ;;AACA,UAAMO,QAAQ,GAAG,KAAKT,KAAL,CAAWZ,IAAX,CAAgBM,GAAhB,GAChB,GAAErB,OAAO,CAACC,GAAR,CAAYC,iBAAkB,eAAc,KAAKyB,KAAL,CAAWZ,IAAX,CAAgBM,GAAI,IAAG,IAAIgB,IAAJ,GAAWC,OAAX,EAAqB,EAD1E,GACgF;AAChGpD,IAAAA,aAFD;AAID,wBACI;AAAK,MAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAI,MAAA,SAAS,EAAC,WAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBADJ,eAGI;AAAK,MAAA,SAAS,EAAC,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAK,MAAA,SAAS,EAAC,UAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAK,MAAA,KAAK,EAAI;AAACqD,QAAAA,MAAM,EAAE,OAAT;AAAkBC,QAAAA,KAAK,EAAE;AAAzB,OAAd;AAAgD,MAAA,SAAS,EAAC,eAA1D;AAA0E,MAAA,GAAG,EAAEJ,QAA/E;AAAyF,MAAA,OAAO,EAAEK,CAAC,IAAKA,CAAC,CAACC,MAAF,CAASC,GAAT,GAAc,GAAEzD,aAAc,EAAtI;AAA0I,MAAA,GAAG,EAAE,KAAKyC,KAAL,CAAWZ,IAAX,CAAgB6B,IAA/J;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,CADJ,eAMI;AAAK,MAAA,SAAS,EAAC,UAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAK,MAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAAW,KAAKjB,KAAL,CAAWZ,IAAX,CAAgB6B,IAA3B,CADJ,eAEI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAAW,KAAKjB,KAAL,CAAWZ,IAAX,CAAgB8B,KAA3B,CAFJ,eAGI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAAM,aAAY,IAAIR,IAAJ,CAAS,KAAKV,KAAL,CAAWZ,IAAX,CAAgB+B,OAAzB,EAAkCC,YAAlC,EAAiD,EAAnE,CAHJ,CADJ,EAUK3D,eAAe,GAAG2B,IAAlB,IAA0B3B,eAAe,GAAG2B,IAAlB,CAAuBM,GAAvB,KAA+B,KAAKM,KAAL,CAAWZ,IAAX,CAAgBM,GAAzE,gBACG;AAAK,MAAA,SAAS,EAAC,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI,oBAAC,IAAD;AAAM,MAAA,SAAS,EAAC,8BAAhB;AACA,MAAA,EAAE,EAAG,cADL;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBADJ,eAMI,oBAAC,IAAD;AAAM,MAAA,SAAS,EAAC,iCAAhB;AACA,MAAA,EAAE,EAAG,cAAa,KAAKM,KAAL,CAAWZ,IAAX,CAAgBM,GAAI,EADtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBANJ,CADH,gBAaI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAvBT,CANJ,CAHJ,CADJ;AAyCH;;AA1H2B;;AA6HhC,eAAe3B,OAAf","sourcesContent":["import React, { Component } from 'react';\nimport { Redirect, Link } from 'react-router-dom';\nimport DefaultAvatar from '../images/default_avatar.png';\nimport {postsByUser} from '../post/postAPI'\n\n//is authenticated method checks if the user is authenticated (checks the token in local storage)\n//we can conditionally show and hide links based on this helper method\nexport const isAuthenticated =() =>{\n    if(typeof window == \"undefined\"){\n        return false;\n    }\n\n    if(localStorage.getItem(\"JWT\")){\n        //parse the token (as it contains user information)\n        return JSON.parse(localStorage.getItem(\"JWT\"))\n    }else{\n        return false;\n    }\n}\n\nclass Profile extends Component {\n    // state\n    constructor(){\n        super()\n        this.state ={\n            user: {following: [], followers: []},\n            redirectToSignin:false,\n            following: false, \n            error:\"\",\n            posts:[]\n        }\n    }\n\n    //takes userId from the init\n    read = (userId, token)=>{\n        return fetch(`${process.env.REACT_APP_API_URL}/user/${userId}`, {\n            method:\"GET\",\n            // to make only authenticated user make the request\n            headers: {\n                Accept: \"application/json\",\n                \"Content-Type\": \"application/json\",\n                // jwt token from the isAuthenticated function\n                Authorization: `Bearer ${token}`\n            }\n        })\n        .then(response =>{\n            return response.json()\n        })\n        .catch(err => console.log(err))\n    }\n\n    //for conditional rendering of the follow/ unfollow buttons\n    //checks users followers list -> takes user as arguement returns true/false\n    checkFollow = user =>{\n        const jwt = isAuthenticated()\n\n        //if the signed in user's id is found then it means the user is already in the followers list\n        const match = user.followers.find(follower =>{\n            return follower._id === jwt.user._id\n        })\n        return match\n    }\n\n    //postsByUser (userId , token)-> runs when loadPosts run with init which is run when the component mounts\n    loadPosts = userId => {\n        const token = isAuthenticated().token;\n        postsByUser(userId, token)\n        .then(data =>{\n            if(data.error){console.log(data.error)}\n            else{this.setState({posts:data})}\n        })\n        \n    }\n    \n\n    //lifecycle method -> when the component is mounted and be ready\n    //then we get the user id\n    componentDidMount(){\n        // console.log(\"Userrouter from route params:\", this.props.match.params.userId);\n        const userId = this.props.match.params.userId\n        //giving userId to init method to process\n        this.init(userId)\n    }\n\n    //when the userid in the url changes this method gets invoked \n    //and executes init method but with different userId\n    componentWillReceiveProps(props){\n        const userId = props.match.params.userId\n        //giving userId to init method to process\n        this.init(userId)\n    }\n\n    render() {\n        const redirectToSignin = this.state.redirectToSignin\n        if(redirectToSignin) return <Redirect to=\"/login\"/>\n\n         //this URL gives us image\n         const photoUrl = this.state.user._id ? \n         `${process.env.REACT_APP_API_URL}/user/photo/${this.state.user._id}?${new Date().getTime()}` :   //new Date().getTime() => gives us the newly updated image\n          DefaultAvatar\n\n        return (\n            <div className=\"container\">\n                <h2 className=\"mt-5 mb-5\">PROFILE PAGE</h2>\n\n                <div className=\"row\">\n                    <div className=\"col-md-4\">\n                        <img style = {{height: \"200px\", width: \"auto\"}} className=\"img-thumbnail\" src={photoUrl} onError={i => (i.target.src=`${DefaultAvatar}`)} alt={this.state.user.name}/>\n\n                        {/* <img className=\"card-img-top\" style ={{width: \"100%\", height: \"15vw\", objectFit:\"cover\"}} src={DefaultAvatar} alt={this.state.user.name}/> */}\n                    </div>\n                    <div className=\"col-md-8\">\n                        <div className=\"lead mt-2\">\n                            <p>Hello! {this.state.user.name}</p>\n                            <p>Email: {this.state.user.email}</p>\n                            <p> {`Joined on ${new Date(this.state.user.created).toDateString()}`}</p>\n                        </div>\n                        {/* check for authenticated user wether it matches the current userId in the state */}\n                        {/* {console.log(\"USER\", isAuthenticated().user)}\n                        {console.log(\"UserID\",isAuthenticated().user._id)}\n                        {console.log(\"StateUserID\",this.state.user._id )} */}\n                        {isAuthenticated().user && isAuthenticated().user._id === this.state.user._id ? (\n                            <div className=\"d-inline-block\">\n                                <Link className=\"btn btn-raised btn-info mr-5\"\n                                to={`/post/create`}\n                                >\n                                        CREATE POST\n                                </Link>\n                                <Link className=\"btn btn-raised btn-success mr-5\"\n                                to={`/user/edit/${this.state.user._id}`}\n                                >\n                                        Edit Profile\n                                </Link>\n                            </div>\n                        ) : (<div></div>)\n                         }\n\n                        </div>\n                    </div>\n                       \n                </div>\n        );\n    }\n}\n\nexport default Profile;"]},"metadata":{},"sourceType":"module"}