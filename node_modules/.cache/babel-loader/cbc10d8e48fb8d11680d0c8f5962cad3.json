{"ast":null,"code":"var _jsxFileName = \"E:\\\\Agile Web App\\\\social media (frontend)\\\\src\\\\user\\\\Profile.js\";\nimport React, { Component } from 'react';\nimport { Redirect, Link } from 'react-router-dom';\nimport DefaultAvatar from '../images/default_avatar.png';\nimport DeleteUser from \"./DeleteUser\";\nimport FollowButton from \"../followUnfollowComponent/FollowButton\";\nimport ProfileTabs from \"../followUnfollowComponent/ProfileTab\";\nimport { postsByUser } from '../post/postAPI'; //is authenticated method checks if the user is authenticated (checks the token in local storage)\n//we can conditionally show and hide links based on this helper method\n\nexport const isAuthenticated = () => {\n  if (typeof window == \"undefined\") {\n    return false;\n  }\n\n  if (localStorage.getItem(\"JWT\")) {\n    //parse the token (as it contains user information)\n    return JSON.parse(localStorage.getItem(\"JWT\"));\n  } else {\n    return false;\n  }\n};\n\nclass Profile extends Component {\n  // state\n  constructor() {\n    super();\n\n    this.read = (userId, token) => {\n      return fetch(`${process.env.REACT_APP_API_URL}/user/${userId}`, {\n        method: \"GET\",\n        // to make only authenticated user make the request\n        headers: {\n          Accept: \"application/json\",\n          \"Content-Type\": \"application/json\",\n          // jwt token from the isAuthenticated function\n          Authorization: `Bearer ${token}`\n        }\n      }).then(response => {\n        return response.json();\n      }).catch(err => console.log(err));\n    };\n\n    this.checkFollow = user => {\n      const jwt = isAuthenticated(); //if the signed in user's id is found then it means the user is already in the followers list\n\n      const match = user.followers.find(follower => {\n        return follower._id === jwt.user._id;\n      });\n      return match;\n    };\n\n    this.clickFollow = callApi => {\n      const userId = isAuthenticated().user._id;\n\n      const token = isAuthenticated().token;\n      callApi(userId, token, this.state.user._id).then(data => {\n        if (data.error) {\n          this.setState({\n            error: data.error\n          });\n        } else {\n          //populating following as not state (if follow is clicked then unfollow and viceversa)\n          this.setState({\n            user: data,\n            following: !this.state.following\n          }); //whatever it was done, we need to alter the value\n        }\n      });\n    };\n\n    this.init = userId => {\n      const token = isAuthenticated().token;\n      this.read(userId, token).then(data => {\n        if (data.error) {\n          this.setState({\n            redirectToSignin: true\n          });\n          console.log(\"ERROR\");\n        } else {\n          // console.log(data)\n          let following = this.checkFollow(data);\n          this.setState({\n            user: data,\n            following\n          }); //to pass the userID to postsByUser()\n\n          this.loadPosts(data._id);\n        }\n      });\n    };\n\n    this.loadPosts = userId => {\n      const token = isAuthenticated().token;\n      postsByUser(userId, token).then(data => {\n        if (data.error) {\n          console.log(data.error);\n        } else {\n          this.setState({\n            posts: data\n          });\n        }\n      });\n    };\n\n    this.state = {\n      user: {\n        following: [],\n        followers: []\n      },\n      redirectToSignin: false,\n      following: false,\n      error: \"\",\n      posts: []\n    };\n  } //takes userId from the init\n\n\n  //lifecycle method -> when the component is mounted and be ready\n  //then we get the user id\n  componentDidMount() {\n    // console.log(\"Userrouter from route params:\", this.props.match.params.userId);\n    const userId = this.props.match.params.userId; //giving userId to init method to process\n\n    this.init(userId);\n  } //when the userid in the url changes this method gets invoked \n  //and executes init method but with different userId\n\n\n  componentWillReceiveProps(props) {\n    const userId = props.match.params.userId; //giving userId to init method to process\n\n    this.init(userId);\n  }\n\n  render() {\n    const redirectToSignin = this.state.redirectToSignin;\n    if (redirectToSignin) return /*#__PURE__*/React.createElement(Redirect, {\n      to: \"/login\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 37\n      }\n    }); //this URL gives us image\n\n    const photoUrl = this.state.user._id ? `${process.env.REACT_APP_API_URL}/user/photo/${this.state.user._id}?${new Date().getTime()}` : //new Date().getTime() => gives us the newly updated image\n    DefaultAvatar;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"h2\", {\n      className: \"mt-5 mb-5\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 17\n      }\n    }, \"PROFILE PAGE\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-md-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      style: {\n        height: \"200px\",\n        width: \"auto\"\n      },\n      className: \"img-thumbnail\",\n      src: photoUrl,\n      onError: i => i.target.src = `${DefaultAvatar}`,\n      alt: this.state.user.name,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 25\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-md-8\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"lead mt-2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 29\n      }\n    }, \"Hello! \", this.state.user.name), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 29\n      }\n    }, \"Email: \", this.state.user.email), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 29\n      }\n    }, \" \", `Joined on ${new Date(this.state.user.created).toDateString()}`)), isAuthenticated().user && isAuthenticated().user._id === this.state.user._id ? /*#__PURE__*/React.createElement(\"div\", {\n      className: \"d-inline-block\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(Link, {\n      className: \"btn btn-raised btn-info mr-5\",\n      to: `/post/create`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 33\n      }\n    }, \"CREATE POST\"), /*#__PURE__*/React.createElement(Link, {\n      className: \"btn btn-raised btn-success mr-5\",\n      to: `/user/edit/${this.state.user._id}`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 33\n      }\n    }, \"Edit Profile\"), /*#__PURE__*/React.createElement(DeleteUser, {\n      userId: this.state.user._id,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 33\n      }\n    }), \" \") : /*#__PURE__*/React.createElement(FollowButton, {\n      following: this.state.following,\n      onButtonClick: this.clickFollow,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 30\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 25\n      }\n    }, isAuthenticated().user && isAuthenticated().user.role === \"admin\" && /*#__PURE__*/React.createElement(\"div\", {\n      class: \"card mt-5\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"card-body\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 41\n      }\n    }, /*#__PURE__*/React.createElement(\"h5\", {\n      className: \"card-title\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 45\n      }\n    }, \"SUPER ADMIN\"), /*#__PURE__*/React.createElement(\"p\", {\n      className: \"mb-2 text-danger\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 45\n      }\n    }, \"UPDATE/DELETE as SuperAdmin\"), /*#__PURE__*/React.createElement(Link, {\n      className: \"btn btn-raised btn-info mr-5\",\n      to: `/user/edit/${this.state.user._id}`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 45\n      }\n    }, \"Edit Profile\"), /*#__PURE__*/React.createElement(DeleteUser, {\n      userId: this.state.user._id,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 45\n      }\n    })))))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col md-12 mt-5 mb-5\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"hr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208,\n        columnNumber: 29\n      }\n    }), /*#__PURE__*/React.createElement(\"p\", {\n      className: \"lead\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 29\n      }\n    }, this.state.user.about), /*#__PURE__*/React.createElement(\"hr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 29\n      }\n    }), /*#__PURE__*/React.createElement(ProfileTabs, {\n      followers: this.state.user.followers,\n      following: this.state.user.following,\n      posts: this.state.posts,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 29\n      }\n    }))));\n  }\n\n}\n\nexport default Profile;","map":{"version":3,"sources":["E:/Agile Web App/social media (frontend)/src/user/Profile.js"],"names":["React","Component","Redirect","Link","DefaultAvatar","DeleteUser","FollowButton","ProfileTabs","postsByUser","isAuthenticated","window","localStorage","getItem","JSON","parse","Profile","constructor","read","userId","token","fetch","process","env","REACT_APP_API_URL","method","headers","Accept","Authorization","then","response","json","catch","err","console","log","checkFollow","user","jwt","match","followers","find","follower","_id","clickFollow","callApi","state","data","error","setState","following","init","redirectToSignin","loadPosts","posts","componentDidMount","props","params","componentWillReceiveProps","render","photoUrl","Date","getTime","height","width","i","target","src","name","email","created","toDateString","role","about"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { Redirect, Link } from 'react-router-dom';\nimport DefaultAvatar from '../images/default_avatar.png';\nimport DeleteUser from \"./DeleteUser\"\nimport FollowButton from \"../followUnfollowComponent/FollowButton\"\nimport ProfileTabs from \"../followUnfollowComponent/ProfileTab\"\nimport {postsByUser} from '../post/postAPI'\n\n//is authenticated method checks if the user is authenticated (checks the token in local storage)\n//we can conditionally show and hide links based on this helper method\nexport const isAuthenticated =() =>{\n    if(typeof window == \"undefined\"){\n        return false;\n    }\n\n    if(localStorage.getItem(\"JWT\")){\n        //parse the token (as it contains user information)\n        return JSON.parse(localStorage.getItem(\"JWT\"))\n    }else{\n        return false;\n    }\n}\n\nclass Profile extends Component {\n    // state\n    constructor(){\n        super()\n        this.state ={\n            user: {following: [], followers: []},\n            redirectToSignin:false,\n            following: false, \n            error:\"\",\n            posts:[]\n        }\n    }\n\n    //takes userId from the init\n    read = (userId, token)=>{\n        return fetch(`${process.env.REACT_APP_API_URL}/user/${userId}`, {\n            method:\"GET\",\n            // to make only authenticated user make the request\n            headers: {\n                Accept: \"application/json\",\n                \"Content-Type\": \"application/json\",\n                // jwt token from the isAuthenticated function\n                Authorization: `Bearer ${token}`\n            }\n        })\n        .then(response =>{\n            return response.json()\n        })\n        .catch(err => console.log(err))\n    }\n\n    //for conditional rendering of the follow/ unfollow buttons\n    //checks users followers list -> takes user as arguement returns true/false\n    checkFollow = user =>{\n        const jwt = isAuthenticated()\n\n        //if the signed in user's id is found then it means the user is already in the followers list\n        const match = user.followers.find(follower =>{\n            return follower._id === jwt.user._id\n        })\n        return match\n    }\n\n    //onclick event\n    //takes function callAi as arguement that makes request to the api\n    //we send this method to child component\n    clickFollow = callApi => {\n        const userId = isAuthenticated().user._id;\n        const token = isAuthenticated().token;\n\n        callApi(userId, token, this.state.user._id)\n        .then(data =>{\n            if(data.error){\n                this.setState({error: data.error})\n            }else{\n                //populating following as not state (if follow is clicked then unfollow and viceversa)\n                this.setState({user: data, following: !this.state.following})  //whatever it was done, we need to alter the value\n            }\n        })\n    }\n\n\n    //it takes arguement from the componentDidMount (userId)\n    init = (userId)=>{\n        const token = isAuthenticated().token;\n        this.read(userId, token)\n        .then(data =>{\n            if(data.error){\n                this.setState({redirectToSignin: true})\n                console.log(\"ERROR\")\n            }\n            else{\n                // console.log(data)\n                let following = this.checkFollow(data)\n                this.setState({user: data, following}) \n                //to pass the userID to postsByUser()\n                this.loadPosts(data._id)\n            }\n        })\n    }\n\n\n    //postsByUser (userId , token)-> runs when loadPosts run with init which is run when the component mounts\n    loadPosts = userId => {\n        const token = isAuthenticated().token;\n        postsByUser(userId, token)\n        .then(data =>{\n            if(data.error){console.log(data.error)}\n            else{this.setState({posts:data})}\n        })\n        \n    }\n    \n\n    //lifecycle method -> when the component is mounted and be ready\n    //then we get the user id\n    componentDidMount(){\n        // console.log(\"Userrouter from route params:\", this.props.match.params.userId);\n        const userId = this.props.match.params.userId\n        //giving userId to init method to process\n        this.init(userId)\n    }\n\n    //when the userid in the url changes this method gets invoked \n    //and executes init method but with different userId\n    componentWillReceiveProps(props){\n        const userId = props.match.params.userId\n        //giving userId to init method to process\n        this.init(userId)\n    }\n\n    render() {\n        const redirectToSignin = this.state.redirectToSignin\n        if(redirectToSignin) return <Redirect to=\"/login\"/>\n\n         //this URL gives us image\n         const photoUrl = this.state.user._id ? \n         `${process.env.REACT_APP_API_URL}/user/photo/${this.state.user._id}?${new Date().getTime()}` :   //new Date().getTime() => gives us the newly updated image\n          DefaultAvatar\n\n        return (\n            <div className=\"container\">\n                <h2 className=\"mt-5 mb-5\">PROFILE PAGE</h2>\n\n                <div className=\"row\">\n                    <div className=\"col-md-4\">\n                        <img style = {{height: \"200px\", width: \"auto\"}} className=\"img-thumbnail\" src={photoUrl} onError={i => (i.target.src=`${DefaultAvatar}`)} alt={this.state.user.name}/>\n\n                        {/* <img className=\"card-img-top\" style ={{width: \"100%\", height: \"15vw\", objectFit:\"cover\"}} src={DefaultAvatar} alt={this.state.user.name}/> */}\n                    </div>\n                    <div className=\"col-md-8\">\n                        <div className=\"lead mt-2\">\n                            <p>Hello! {this.state.user.name}</p>\n                            <p>Email: {this.state.user.email}</p>\n                            <p> {`Joined on ${new Date(this.state.user.created).toDateString()}`}</p>\n                        </div>\n                        {/* check for authenticated user wether it matches the current userId in the state */}\n                        {/* {console.log(\"USER\", isAuthenticated().user)}\n                        {console.log(\"UserID\",isAuthenticated().user._id)}\n                        {console.log(\"StateUserID\",this.state.user._id )} */}\n                        {isAuthenticated().user && isAuthenticated().user._id === this.state.user._id ? (\n                            <div className=\"d-inline-block\">\n                                <Link className=\"btn btn-raised btn-info mr-5\"\n                                to={`/post/create`}\n                                >\n                                        CREATE POST\n                                </Link>\n                                <Link className=\"btn btn-raised btn-success mr-5\"\n                                to={`/user/edit/${this.state.user._id}`}\n                                >\n                                        Edit Profile\n                                </Link>\n                                <DeleteUser userId = {this.state.user._id} /> {/* using DeleteUser Component and passing userId as props*/}\n                            </div>\n                        ) : (<FollowButton following={this.state.following} onButtonClick={this.clickFollow}/>)}\n\n                        {/* SuperAdmin Update/Delete */}\n                        <div>\n                            {isAuthenticated().user &&\n                                isAuthenticated().user.role === \"admin\" && (\n                                    <div class=\"card mt-5\">\n                                        <div className=\"card-body\">\n                                            <h5 className=\"card-title\">\n                                                SUPER ADMIN\n                                            </h5>\n                                            <p className=\"mb-2 text-danger\">\n                                                UPDATE/DELETE as SuperAdmin\n                                            </p>\n                                            <Link\n                                                className=\"btn btn-raised btn-info mr-5\"\n                                                to={`/user/edit/${this.state.user._id}`}\n                                            >\n                                                Edit Profile\n                                            </Link>\n                                            <DeleteUser userId={this.state.user._id} />\n                                        </div>\n                                    </div>\n                                )}\n                        </div>\n                    </div>\n                       \n                </div>\n                <div className=\"row\">\n                        <div className=\"col md-12 mt-5 mb-5\">\n                            <hr/>\n                            <p className=\"lead\">{this.state.user.about}</p>\n                            <hr/>\n                            <ProfileTabs \n                                followers={this.state.user.followers} \n                                following={this.state.user.following}\n                                posts={this.state.posts}\n                            />\n                        </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default Profile;"]},"metadata":{},"sourceType":"module"}